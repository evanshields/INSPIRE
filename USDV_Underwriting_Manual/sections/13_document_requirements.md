---
section: 13
title: Document Requirements & Diligence
version: 1.0
last_updated: 2025-12-30
model_used: haiku
---

# Section 13: Document Requirements & Diligence

## Overview

This section defines the complete document requirements for all USDV Capital loan products. Documents are organized by loan type (RTL vs DSCR), client type (New, Existing, or RE CFO), and loan purpose. These requirements drive the diligence checklist generation in INSPIRE Phase 5-6.

The section also provides guidance on which documents can be waived for existing clients based on document currency and prior USDV funding history.

---

## 13.1 Document Matrix Overview

Document requirements are determined by three primary factors:

### 1. Loan Type
- **RTL (Fix & Flip, GUC, Bridge):** Property-focused documents emphasizing condition, construction, and exit strategy
- **DSCR (Permanent Rental):** Cash-flow-focused documents emphasizing income, tenancy, and operating expenses

### 2. Client Type
- **New Client:** All documents required
- **Existing Client:** Some documents may be waived if recently provided and current
- **RE CFO Program:** Streamlined documentation for established borrowers with track record

### 3. Loan Purpose (For DSCR)
- **Purchase:** Full documentation required
- **Refinance (R&T):** Reduced documentation if eligible
- **Cash-Out Refinance:** Enhanced property documentation required

---

## 13.2 RTL Document Requirements (Fix & Flip, GUC, Bridge)

### 13.2.1 Borrower Documents (All RTL Loans)

| Document | Type | Requirement | Currency | New Client | Existing Client |
|----------|------|-------------|----------|------------|-----------------|
| **Credit Report (Tri-Merge)** | Required | All borrowers and guarantors | 120 days | ✓ | ✓ |
| **Background Check** | Required | All borrowers and guarantors | 120 days | ✓ | ✓ |
| **Personal Financial Statement** | Required | All guarantors | Current | ✓ | ✓ |
| **Bank Statements (2 months)** | Required | All guarantors | 90 days | ✓ | ✓ |
| **Schedule of Real Estate Owned** | Required | All guarantors | Current | ✓ | ✓ |
| **Personal Tax Returns (2 years)** | Required | All guarantors | Current (filed) | ✓ | ✓ |
| **Corporate/Entity Tax Returns (2 years)** | Required | Borrowing entity | Current (filed) | ✓ | ✓ |
| **Proof of Funds (Down Payment)** | Conditional | If purchase with down payment | 60 days | ✓ | - |
| **Letter of Explanation** | Conditional | For any credit derogatory items | Within diligence | ✓ | - |
| **Professional License Verification** | Conditional | If contractor/realtor/license holder | Current | ✓ | - |

### 13.2.2 Entity Documents (All RTL Loans)

| Document | Type | Requirement | Currency | New Client | Existing Client |
|----------|------|-------------|----------|------------|-----------------|
| **Articles of Organization/Incorporation** | Required | All entity borrowers | Original on file | ✓ | ✓ |
| **Operating Agreement/Bylaws** | Required | All entity borrowers | Current version | ✓ | ✓ |
| **Certificate of Good Standing** | Required | All entity borrowers | 90 days | ✓ | ✓ |
| **EIN Letter or W-9** | Required | All entity borrowers | Current | ✓ | ✓ |
| **Business License/Registration** | Required | Entity actively operating | Current | ✓ | ✓ |
| **Ownership/Capitalization Chart** | Required | Multi-member entities | Current | ✓ | ✓ |
| **Manager/Board Minutes** | Required | If manager approval needed | Dated appropriately | ✓ | - |

### 13.2.3 Property Documents (All RTL Loans)

| Document | Type | Requirement | Currency | New Client | Existing Client |
|----------|------|-------------|----------|------------|-----------------|
| **Purchase Agreement** | Required | Purchase transactions | Signed copy | ✓ | - |
| **Current Appraisal** | Required | All loans | 120 days from note date | ✓ | ✓ |
| **Title Commitment** | Required | All loans | 60 days | ✓ | ✓ |
| **Survey** | Conditional | If lender requirement or unclear boundaries | Within past 2 years | - | - |
| **Flood Certification** | Required | All properties | Current | ✓ | ✓ |

### 13.2.4 RTL-Specific Documents (By Product)

#### Fix & Flip (Purchase/Refinance)
| Document | Requirement | Currency | Details |
|----------|-------------|----------|---------|
| **Scope of Work (SOW)** | Required | Dated at application | Detailed itemized rehab plan |
| **Construction Budget** | Required | Dated at application | Line-item costs with contingency (min 5%) |
| **Contractor/GC Information** | Required | Current | Licensed GC if required; contact info; estimates |
| **Before Photos** | Required | Within 30 days of appraisal | Interior and exterior (min 20 photos) |
| **Feasibility Study** | Required if heavy rehab | Current (within appraisal period) | Budget variance analysis, timeline, contingency |
| **Lien Waiver/Release** | Required if refi | Dated at closing | For all prior contractors (if applicable) |
| **ARV Market Study** | Required if ARV >$500K | Current | Comparable analysis supporting ARV estimate |

#### Ground-Up Construction (GUC)
| Document | Requirement | Currency | Details |
|----------|-------------|----------|---------|
| **Land Purchase Agreement** | Required | Signed | Or deed if already owned |
| **Detailed Plans & Specs** | Required | Stamped by architect | Lot plan, floor plan, elevation, site plan |
| **Development Timeline** | Required | Realistic | Permits → construction → completion → sale/refi |
| **Permit Status** | Required | Current | List of all required permits with status |
| **Construction Budget (By Phase)** | Required | Detailed | Hard costs, soft costs, contingency (min 5%), financing costs |
| **Contractor/Builder Credentials** | Required | Current | GC license, insurance cert, references from prior GUC projects |
| **Pre-Construction Meeting Notes** | Conditional | Before initial draw | Lender representative present |
| **Appraisal (As-Complete)** | Required | Within 120 days before note date | GUC appraisals typically obtained at completion |

#### Bridge Loan
| Document | Requirement | Currency | Details |
|----------|-------------|----------|---------|
| **Exit Strategy Documentation** | Required | Current | If sale: MLS listings, realtor comps; if refi: pre-approval letter |
| **Days-on-Market Analysis** | Conditional | If sale exit and market uncertain | Market absorption data supporting timeline |
| **Refinance Pre-Qualification** | Conditional | If refi exit strategy | Letter from DSCR lender confirming eligibility/rate |
| **SOW/Construction Budget** | Required if value-add | Current | If bridge includes renovation component |

### 13.2.5 Closing Documents (All RTL)

| Document | Type | Requirement | Notes |
|----------|------|-------------|-------|
| **Executed Note** | Required | Final | Signed by all borrowers |
| **Mortgage/Deed of Trust** | Required | Final | Recorded; all required riders attached |
| **Title Insurance Policy** | Required | Issued at closing | Amount = loan amount |
| **Hazard Insurance Certificate** | Required | Binder or policy | Mortgagee clause in place |
| **Closing Disclosure (CD)** | Required | Final | TRID-compliant |
| **Loan Estimate** | Reference | For TRID file | If applicable |
| **HUD-1/Closing Statement** | Required | Final | All closing costs detailed |
| **Personal Guarantee** | Required | Executed | All required guarantors |
| **Borrower Certification Form** | Required | Executed | Business purpose affidavit |

---

## 13.3 DSCR Document Requirements (Permanent Rental)

### 13.3.1 Borrower Documents (All DSCR Loans)

| Document | Type | Requirement | Currency | New Client | Existing Client |
|----------|------|-------------|----------|------------|-----------------|
| **Credit Report (Tri-Merge)** | Required | All borrowers and guarantors | 120 days | ✓ | ✓ |
| **Background Check** | Required | All borrowers and guarantors | 120 days | ✓ | ✓ |
| **Personal Financial Statement** | Required | All guarantors | Current | ✓ | ✓ |
| **Bank Statements (2 months)** | Required | All guarantors | 90 days | ✓ | ✓ |
| **Schedule of Real Estate Owned** | Required | All guarantors | Current | ✓ | ✓ |
| **Personal Tax Returns (2 years)** | Required | All guarantors | Current (filed) | ✓ | ✓ |
| **Corporate/Entity Tax Returns (2 years)** | Required | Borrowing entity | Current (filed) | ✓ | ✓ |
| **Proof of Funds (Down Payment)** | Conditional | If purchase with down payment | 60 days | ✓ | - |
| **Letter of Explanation** | Conditional | For any credit derogatory items | Within diligence | ✓ | - |
| **Verification of Employment/Income** | Conditional | If guarantor has W2 income | Current (within 10 days) | - | - |

### 13.3.2 Entity Documents (All DSCR Loans)

| Document | Type | Requirement | Currency | New Client | Existing Client |
|----------|------|-------------|----------|------------|-----------------|
| **Articles of Organization/Incorporation** | Required | All entity borrowers | Original on file | ✓ | ✓ |
| **Operating Agreement/Bylaws** | Required | All entity borrowers | Current version | ✓ | ✓ |
| **Certificate of Good Standing** | Required | All entity borrowers | 90 days | ✓ | ✓ |
| **EIN Letter or W-9** | Required | All entity borrowers | Current | ✓ | ✓ |
| **Business License/Registration** | Conditional | If entity actively operating | Current | - | - |
| **Ownership/Capitalization Chart** | Required | Multi-member entities | Current | ✓ | ✓ |

### 13.3.3 Property Documents (All DSCR Loans)

| Document | Type | Requirement | Currency | New Client | Existing Client |
|----------|------|-------------|----------|------------|-----------------|
| **Purchase Agreement** | Required | Purchase transactions | Signed copy | ✓ | - |
| **Current Appraisal** | Required | All loans | 120 days from note date | ✓ | ✓ |
| **Title Commitment** | Required | All loans | 60 days | ✓ | ✓ |
| **Survey** | Conditional | If lender requirement or unclear boundaries | Within past 2 years | - | - |
| **Flood Certification** | Required | All properties | Current | ✓ | ✓ |

### 13.3.4 DSCR-Specific Documents (By Loan Purpose)

#### DSCR - Purchase or Rate & Term Refi
| Document | Requirement | Currency | Details |
|----------|-------------|----------|---------|
| **Current Lease(s)** | Required | Executed and current | Full copy signed by all parties |
| **Lease Rider (if required)** | Conditional | Executed | If property address or terms need clarification |
| **Tenant Verification Letter** | Required | Current (within 30 days) | Confirming occupancy, rent, payment history |
| **Rent Roll** | Required if multi-unit | Current | All units with lease status and rent amounts |
| **Operating Expense Documentation** | Required if 5+ units | Trailing 12 months | Prior 12 months of actual expenses |
| **Property Management Agreement** | Required if 3+ units | Current | Or evidence of self-management |
| **12-Month Bank Deposits** | Conditional | Current | If verifying actual collections vs. lease |
| **Rent Roll with Supporting Evidence** | Required | Current | For cash-out refis with new rent assumptions |

#### DSCR - Cash-Out Refinance
| Document | Requirement | Currency | Details |
|----------|-------------|----------|---------|
| **Original Purchase Documents** | Required | Recorded | Deed and original HUD showing purchase price |
| **Appraisal with Updated ARV** | Required | Current (120 days) | Supporting increased value for cash-out |
| **Scope of Work (if value-add)** | Required | Current | If cash-out justified by improvements |
| **Before/After Documentation** | Conditional | Current | Photos and receipts if renovations completed |
| **Updated Lease(s)** | Required | Current | If property rented after purchase |
| **Tenant Verification** | Required | Current (within 30 days) | Confirming occupancy and rent payment |
| **Enhanced Property Appraisal** | Required | Market Rent Addendum | Form 1007 with rent justification |

#### DSCR - Unleased Property (Refinance)
| Document | Requirement | Currency | Details |
|----------|-------------|----------|---------|
| **Market Rent Analysis** | Required | Current (within 90 days) | Professional rent study or broker estimate |
| **Comparable Lease Documentation** | Required | Current | Sample leases from comparable properties |
| **Marketing Plan** (if required) | Conditional | Current | Timeline for lease-up and rent assumptions |
| **Updated Property Appraisal** | Required | Form 1007 - Market Rent | Current market rent determination |

#### DSCR - Short-Term Rental (STR) / Vacation Rental
| Document | Requirement | Currency | Details |
|----------|-------------|----------|---------|
| **Online Listing Verification** | Required | Current | Screenshot from Airbnb/VRBO/other platform |
| **Property Management Agreement** | Required if not self-managed | Current | Evidence of professional management |
| **12-Month Income Statement** | Required | Trailing 12 months | Actual income from platform, showing monthly breakdown |
| **Platform Account Access** | Required | Verified | Guarantor to provide access for income verification |
| **RentRange Report** | Required | Current | Professional market analysis of STR rental rates |
| **Hazard Insurance** | Required | Special rider | Must cover vacation rental use (not standard HO policy) |

### 13.3.5 Closing Documents (All DSCR)

| Document | Type | Requirement | Notes |
|----------|------|-------------|-------|
| **Executed Note** | Required | Final | Signed by all borrowers; amortization schedule attached |
| **Mortgage/Deed of Trust** | Required | Final | Recorded; all required riders attached |
| **Title Insurance Policy** | Required | Issued at closing | Amount = loan amount; ALTA 2006 or equivalent |
| **Hazard Insurance Certificate** | Required | Binder or policy | Mortgagee clause; 1-year binder minimum |
| **Rent Loss Insurance** (Conditional) | Required if 5+ units | Binder or policy | 6-month rent loss coverage |
| **Condo Master Policy** | Required if condo | Proof of issuance | For multi-unit condo buildings |
| **HO6/Walls-In Insurance** | Required if condo | Binder or policy | Condo owner's coverage |
| **Closing Disclosure (CD)** | Required | Final | TRID-compliant |
| **HUD-1/Closing Statement** | Required | Final | All closing costs detailed |
| **Personal Guarantee** | Required | Executed | 100% of entity ownership |
| **Borrower Certification Form** | Required | Executed | Business purpose affidavit |
| **Lease(s)** | Required | Final executed | All tenant leases on file at closing |

---

## 13.4 Third-Party Reports & Analysis Documents

### All Loans (RTL and DSCR)

| Document | Requirement | Ordering Timeline | Currency | Notes |
|----------|-------------|-------------------|----------|-------|
| **Appraisal** | Required | Phase 5-6 | 120 days from note date | Full interior appraisal standard |
| **Title Commitment** | Required | Phase 5-6 | 60 days from closing | Must show subject property clearly |
| **Flood Certification** | Required | Phase 5-6 | Within 30 days of closing | Updated if property near flood zone |
| **Credit Report** | Required | Phase 3 (updated Phase 5-6) | 120 days from closing | Tri-merge with all borrower/guarantor coverage |
| **Background Check** | Required | Phase 3 (updated Phase 5-6) | 120 days from closing | Criminal, civil, OFAC, liens, judgments |
| **HOA Documents** | Required if condo/HOA | Phase 5-6 | Current | CC&Rs, bylaws, financial statements, budget |

### RTL-Specific Reports

| Document | Requirement | Ordering Timeline | Notes |
|----------|-------------|-------------------|-------|
| **Feasibility Study** | Required if heavy rehab | Phase 5-6 | When rehab >50K or >100% of value |
| **Reconsideration of Value (ROV)** | Conditional | Phase 6 if needed | If initial appraisal variance >10% |
| **Survey** | Conditional | Phase 5-6 | If title shows no recent survey/issues |
| **Mold/Environmental Assessment** | Conditional | Phase 5-6 | If condition report indicates concerns |

### DSCR-Specific Reports

| Document | Requirement | Ordering Timeline | Notes |
|----------|-------------|-------------------|-------|
| **RentRange Report** | Required if STR | Phase 5-6 | For vacation rental income verification |
| **RentRange Report** | Conditional if unleased | Phase 5-6 | Market rent verification for unleased properties |
| **Market Rent Addendum (Form 1007)** | Required | Phase 5-6 | Included with appraisal for all DSCR loans |
| **Property Management Agreement Review** | Required if 3+ units | Phase 5-6 | Verify professional management or self-management |

---

## 13.5 Document Currency Requirements Summary

All documents must be current as of loan closing date:

| Document Category | Maximum Age | Effective Date |
|---|---|---|
| **Credit Report** | 120 days | From closing/note date |
| **Background Check** | 120 days | From closing/note date |
| **Bank Statements** | 90 days | Most recent month before closing |
| **Certificate of Good Standing** | 90 days | From closing/note date |
| **Appraisal** | 120 days | From closing/note date |
| **Title Commitment** | 60 days | From closing date |
| **Flood Certification** | 30 days | Before closing (ordered in diligence phase) |
| **Hazard Insurance** | Active at closing | 1-year binder minimum |
| **Property Tax Records** | Current (annual) | As of tax year |
| **Personal/Corporate Tax Returns** | Filed (current year or prior) | 2 most recent years required |
| **Personal Financial Statement** | 90 days | Current as of closing |
| **Lease Agreement** | Executed and current | Active at closing |
| **Feasibility Study** | Within appraisal date | ≤120 days old |
| **RentRange/Market Analysis** | 90 days | Current market data |

---

## 13.6 Existing Client Streamlining

For borrowers who have previously closed USDV loans, certain documents may be waived or updated rather than fully replaced, subject to the following rules:

### 13.6.1 When Streamlining Applies

**Criteria for Streamlining:**
1. Borrower has closed minimum 1 prior USDV loan
2. Prior loan(s) are performing on schedule (no payment issues)
3. No new adverse credit events since prior loan closing
4. Loan product and terms similar to prior funding (lower risk if different product)
5. Time since prior loan closing determines which documents can be waived

### 13.6.2 Documents Commonly Waived for Existing Clients

#### Waivable After Prior USDV Loan (0-6 months)
| Document | Condition for Waiver | Guidance |
|----------|---------------------|----------|
| **Personal Financial Statement** | Filed within 6 months | Use most recent on file; verify no material changes |
| **Schedule of Real Estate Owned** | Updated within 6 months | Request update confirming no new properties or sales |
| **Corporate Tax Returns** | Filed within 6 months | If entity unchanged; request confirmation |
| **Articles of Organization** | Not expired | On file from prior loan; confirm still current |
| **Operating Agreement/Bylaws** | Not amended | On file from prior loan; request confirmation of no changes |
| **EIN Letter/W-9** | Not expired | Use prior; request new if >2 years old |
| **Professional License Verification** | Active and current | Verify license status hasn't changed |

#### Waivable with Updated Information (6-12 months)
| Document | Condition for Waiver | Guidance |
|----------|---------------------|----------|
| **Personal Tax Returns** | Prior year filed | Use prior 2 years, add current year when filed |
| **Corporate Tax Returns** | Prior year filed | Use prior 2 years, add current year when filed |
| **Certificate of Good Standing** | Within 90 days of prior loan | Request updated (inexpensive; provides current status) |
| **Business License** | Confirmed still active | Verify business still operating under same structure |

#### Waivable - Always Refresh (Regardless of Timing)
| Document | Reason for Refresh | Timing |
|----------|-------------------|--------|
| **Credit Report** | Condition of loan approval | Always new (within 120 days of closing) |
| **Background Check** | Condition of loan approval | Always new (within 120 days of closing) |
| **Bank Statements** | Verify current liquidity | Always current 2 months (within 90 days of closing) |
| **Certificate of Good Standing** | Legal standing verification | Always current (within 90 days of closing) |
| **Property Appraisal** | Property value verification | Always new (within 120 days of closing) |
| **Title Commitment** | Title status verification | Always new (within 60 days of closing) |
| **Hazard Insurance** | Current policy requirements | Always new/updated |
| **Lease Agreement** | Tenant occupancy verification | Always current for DSCR |

### 13.6.3 Documents NOT Eligible for Waiver

The following documents cannot be waived for existing clients, regardless of prior funding history:

- **Credit Report** (must be current; different from prior loan)
- **Background Check** (must be current; different from prior loan)
- **Appraisal** (property/market-specific; required for each loan)
- **Title Commitment** (required for each property transaction)
- **Closing Documents** (must be created fresh for each loan)
- **Purchase Agreement** (specific to current transaction)
- **Property Documents** (SOW, construction budget, lease, etc. - transaction-specific)
- **Flood Certification** (required for each property)
- **Hazard Insurance** (required for each loan)
- **Business Purpose Affidavit** (required for each loan closing)

### 13.6.4 Existing Client Checklist Language

**For INSPIRE Phase 5-6 diligence checklist, existing clients should see:**

```
EXISTING CLIENT STREAMLINING APPLIED
────────────────────────────────────────────────────────────────────────────────

Based on prior USDV relationship, the following documents are:

[WAIVED - USE ON FILE]:
☐ Personal Financial Statement (dated [DATE] - use on file)
☐ Schedule of Real Estate Owned (use on file, update if major changes)
☐ Articles of Organization (dated [DATE] - still valid, confirm no amendments)

[UPDATED - REFRESH REQUIRED]:
☐ Certificate of Good Standing (ordered 2025-12-30; new cert required - current)
☐ Recent Property Tax Records (use current year tax assessment)

[ALWAYS REQUIRED - FRESH DOCUMENTS]:
☐ Credit Report (tri-merge, 120 days max)
☐ Background Check (120 days max)
☐ Bank Statements (2 months, 90 days max)
☐ Current Appraisal (120 days from note date)
☐ Title Commitment (60 days from closing)
☐ All Loan-Specific Documents (Purchase agreement, SOW, lease, etc.)
☐ All Closing Documents (Closing Disclosure, HUD-1, Insurance certs, etc.)

────────────────────────────────────────────────────────────────────────────────
Reason for Streamlining: [# of prior loans] prior USDV loan(s), all performing
Prior Loan ID(s): [USDV Loan #]
Approval for Streamlining: [UW Manager name, date]
```

---

## 13.7 RE CFO Program (Advanced)

*Note: As currently defined, USDV does not have a formal "RE CFO Program" but has discussed potential streamlining for high-volume borrowers. This section provides framework if such a program is implemented.*

For established real estate companies with significant USDV borrowing history (5+ funded loans in good standing, $5M+ in funded loan volume), alternative documentation may be acceptable:

### 13.7.1 RE CFO Program Eligibility

**Requirements:**
- Minimum 5 USDV loans closed and performing
- Minimum $5,000,000 in total USDV funded loan volume
- Zero payment defaults or covenant violations
- Annual audit or reviewed financial statements (preferred)
- Dedicated credit liaison/relationship contact

### 13.7.2 Streamlined Documentation Available

**For each new RE CFO loan:**
- Use most recent audited/reviewed financial statements (instead of personal tax returns)
- Substitute current business credit report for tri-merge personal credit
- Allow quarterly updated bank account certifications (instead of monthly statements)
- Accept internal rent roll/operating expense documentation (instead of external sources)

**All standard documents still required:**
- Appraisal, title, credit report, background check (always fresh)
- Hazard insurance, property documents, closing docs

---

## 13.8 Python Code: Diligence Checker

```python
from enum import Enum
from typing import List, Dict, Optional, Tuple
from dataclasses import dataclass, field
from datetime import datetime, timedelta

class LoanType(str, Enum):
    """Loan type enumeration."""
    FIX_AND_FLIP = "fix_and_flip"
    GROUND_UP = "ground_up"
    BRIDGE = "bridge"
    DSCR = "dscr"

class ClientType(str, Enum):
    """Client type enumeration."""
    NEW = "new"
    EXISTING = "existing"
    RE_CFO = "re_cfo"

class DocumentCategory(str, Enum):
    """Document categories."""
    BORROWER = "borrower"
    ENTITY = "entity"
    PROPERTY = "property"
    CLOSING = "closing"
    THIRD_PARTY = "third_party"
    RTL_SPECIFIC = "rtl_specific"
    DSCR_SPECIFIC = "dscr_specific"

@dataclass
class Document:
    """Represents a required document."""
    name: str
    category: DocumentCategory
    required: bool = True
    max_age_days: Optional[int] = None
    last_provided_date: Optional[datetime] = None
    
    def is_current(self, reference_date: datetime) -> bool:
        """Check if document is current as of reference date."""
        if not self.max_age_days or not self.last_provided_date:
            return True
        
        age = (reference_date - self.last_provided_date).days
        return age <= self.max_age_days
    
    def days_until_expired(self, reference_date: datetime) -> Optional[int]:
        """Calculate days until document expires."""
        if not self.max_age_days or not self.last_provided_date:
            return None
        
        expiration_date = self.last_provided_date + timedelta(days=self.max_age_days)
        days_remaining = (expiration_date - reference_date).days
        return days_remaining if days_remaining > 0 else None

@dataclass
class DiligenceChecklist:
    """Complete diligence checklist for a deal."""
    deal_id: str
    loan_type: LoanType
    client_type: ClientType
    loan_purpose: str  # e.g., "purchase", "rate_and_term", "cash_out"
    
    # Borrower context
    borrower_name: str
    guarantor_names: List[str] = field(default_factory=list)
    is_entity: bool = False
    
    # Prior USDV relationship
    prior_usdv_loans: int = 0
    prior_usdv_volume: float = 0.0  # in millions
    all_prior_performing: bool = False
    
    # Documents
    required_documents: List[Document] = field(default_factory=list)
    
    # Tracking
    closing_date: Optional[datetime] = None
    created_at: datetime = field(default_factory=datetime.now)
    
    def add_document(self, doc: Document) -> None:
        """Add a document to the checklist."""
        self.required_documents.append(doc)
    
    def get_overdue_documents(self) -> List[Document]:
        """Get all documents that are overdue or expiring."""
        overdue = []
        for doc in self.required_documents:
            if doc.last_provided_date and not doc.is_current(datetime.now()):
                overdue.append(doc)
        return overdue
    
    def get_completion_percentage(self) -> float:
        """Calculate checklist completion percentage."""
        total = len(self.required_documents)
        if total == 0:
            return 100.0
        
        provided = sum(1 for d in self.required_documents if d.last_provided_date)
        return (provided / total) * 100
    
    def get_completion_summary(self) -> Dict:
        """Get detailed completion summary."""
        return {
            "total_required": len(self.required_documents),
            "provided": sum(1 for d in self.required_documents if d.last_provided_date),
            "pending": sum(1 for d in self.required_documents if not d.last_provided_date),
            "expired": len(self.get_overdue_documents()),
            "completion_percent": self.get_completion_percentage(),
        }

class DiligenceChecker:
    """Generate and manage diligence checklists."""
    
    # Document currency requirements (in days)
    CURRENCY_REQUIREMENTS = {
        "credit_report": 120,
        "background_check": 120,
        "bank_statements": 90,
        "good_standing": 90,
        "appraisal": 120,
        "title_commitment": 60,
        "flood_cert": 30,
        "personal_financial_statement": 90,
        "schedule_real_estate": 90,
        "personal_tax_returns": 365,  # Current year plus prior 2
        "corporate_tax_returns": 365,
        "articles_of_org": 1095,  # 3 years - typically not expiring
        "operating_agreement": 1095,
        "ein_letter": 730,  # 2 years
        "insurance_certificate": 365,  # Annual
    }
    
    def __init__(self):
        """Initialize the diligence checker."""
        self.rtl_base_docs = self._build_rtl_base()
        self.dscr_base_docs = self._build_dscr_base()
    
    def _build_rtl_base(self) -> List[Document]:
        """Build base RTL document list."""
        return [
            # Borrower documents
            Document("Credit Report (Tri-Merge)", DocumentCategory.BORROWER, 
                    max_age_days=120),
            Document("Background Check", DocumentCategory.BORROWER, 
                    max_age_days=120),
            Document("Personal Financial Statement", DocumentCategory.BORROWER,
                    max_age_days=90),
            Document("Bank Statements (2 months)", DocumentCategory.BORROWER,
                    max_age_days=90),
            Document("Schedule of Real Estate Owned", DocumentCategory.BORROWER,
                    max_age_days=90),
            Document("Personal Tax Returns (2 years)", DocumentCategory.BORROWER,
                    max_age_days=365),
            Document("Corporate Tax Returns (2 years)", DocumentCategory.BORROWER,
                    max_age_days=365),
            
            # Entity documents
            Document("Articles of Organization", DocumentCategory.ENTITY),
            Document("Operating Agreement", DocumentCategory.ENTITY),
            Document("Certificate of Good Standing", DocumentCategory.ENTITY,
                    max_age_days=90),
            Document("EIN Letter or W-9", DocumentCategory.ENTITY,
                    max_age_days=730),
            
            # Property documents
            Document("Current Appraisal", DocumentCategory.PROPERTY,
                    max_age_days=120),
            Document("Title Commitment", DocumentCategory.PROPERTY,
                    max_age_days=60),
            Document("Flood Certification", DocumentCategory.PROPERTY,
                    max_age_days=30),
        ]
    
    def _build_dscr_base(self) -> List[Document]:
        """Build base DSCR document list."""
        base = self._build_rtl_base()
        # Add DSCR-specific elements (simplified for example)
        return base
    
    def generate_checklist(
        self,
        deal_id: str,
        loan_type: LoanType,
        client_type: ClientType,
        loan_purpose: str,
        borrower_name: str,
        guarantor_names: List[str] = None,
        is_entity: bool = False,
        prior_usdv_loans: int = 0,
        prior_usdv_volume: float = 0.0,
    ) -> DiligenceChecklist:
        """
        Generate a diligence checklist for a deal.
        
        Args:
            deal_id: Deal identifier
            loan_type: Type of loan (RTL, DSCR, etc.)
            client_type: Type of client (new, existing, re_cfo)
            loan_purpose: Loan purpose (purchase, refi, etc.)
            borrower_name: Borrower name
            guarantor_names: List of guarantor names
            is_entity: Whether borrower is entity
            prior_usdv_loans: Number of prior USDV loans
            prior_usdv_volume: Total prior USDV loan volume
            
        Returns:
            DiligenceChecklist object
        """
        checklist = DiligenceChecklist(
            deal_id=deal_id,
            loan_type=loan_type,
            client_type=client_type,
            loan_purpose=loan_purpose,
            borrower_name=borrower_name,
            guarantor_names=guarantor_names or [],
            is_entity=is_entity,
            prior_usdv_loans=prior_usdv_loans,
            prior_usdv_volume=prior_usdv_volume,
            all_prior_performing=True if prior_usdv_loans > 0 else False,
        )
        
        # Build base documents based on loan type
        if loan_type in [LoanType.FIX_AND_FLIP, LoanType.GROUND_UP, LoanType.BRIDGE]:
            base_docs = self.rtl_base_docs
        else:  # DSCR
            base_docs = self.dscr_base_docs
        
        # Add base documents
        for doc in base_docs:
            checklist.add_document(doc)
        
        # Add product-specific documents
        if loan_type == LoanType.FIX_AND_FLIP:
            self._add_ff_documents(checklist)
        elif loan_type == LoanType.GROUND_UP:
            self._add_guc_documents(checklist)
        elif loan_type == LoanType.BRIDGE:
            self._add_bridge_documents(checklist)
        elif loan_type == LoanType.DSCR:
            self._add_dscr_documents(checklist, loan_purpose)
        
        # Apply existing client streamlining
        if client_type == ClientType.EXISTING and prior_usdv_loans > 0:
            self._apply_existing_client_streamlining(checklist)
        
        return checklist
    
    def _add_ff_documents(self, checklist: DiligenceChecklist) -> None:
        """Add Fix & Flip specific documents."""
        ff_docs = [
            Document("Scope of Work", DocumentCategory.RTL_SPECIFIC),
            Document("Construction Budget", DocumentCategory.RTL_SPECIFIC),
            Document("Contractor Information", DocumentCategory.RTL_SPECIFIC),
            Document("Before Photos", DocumentCategory.RTL_SPECIFIC),
            Document("Feasibility Study", DocumentCategory.RTL_SPECIFIC, required=False),
        ]
        for doc in ff_docs:
            checklist.add_document(doc)
    
    def _add_guc_documents(self, checklist: DiligenceChecklist) -> None:
        """Add Ground-Up Construction specific documents."""
        guc_docs = [
            Document("Land Purchase Agreement", DocumentCategory.RTL_SPECIFIC),
            Document("Plans & Specifications", DocumentCategory.RTL_SPECIFIC),
            Document("Development Timeline", DocumentCategory.RTL_SPECIFIC),
            Document("Permit Status Documentation", DocumentCategory.RTL_SPECIFIC),
            Document("Construction Budget (By Phase)", DocumentCategory.RTL_SPECIFIC),
            Document("Contractor/Builder Credentials", DocumentCategory.RTL_SPECIFIC),
        ]
        for doc in guc_docs:
            checklist.add_document(doc)
    
    def _add_bridge_documents(self, checklist: DiligenceChecklist) -> None:
        """Add Bridge loan specific documents."""
        bridge_docs = [
            Document("Exit Strategy Documentation", DocumentCategory.RTL_SPECIFIC),
            Document("Scope of Work (if value-add)", DocumentCategory.RTL_SPECIFIC,
                    required=False),
        ]
        for doc in bridge_docs:
            checklist.add_document(doc)
    
    def _add_dscr_documents(self, checklist: DiligenceChecklist,
                           loan_purpose: str) -> None:
        """Add DSCR specific documents."""
        dscr_docs = [
            Document("Current Lease(s)", DocumentCategory.DSCR_SPECIFIC),
            Document("Tenant Verification Letter", DocumentCategory.DSCR_SPECIFIC),
        ]
        
        if loan_purpose == "cash_out":
            dscr_docs.extend([
                Document("Original Purchase Documents", DocumentCategory.DSCR_SPECIFIC),
                Document("Scope of Work (if value-add)", DocumentCategory.DSCR_SPECIFIC,
                        required=False),
            ])
        
        for doc in dscr_docs:
            checklist.add_document(doc)
    
    def _apply_existing_client_streamlining(
        self,
        checklist: DiligenceChecklist
    ) -> None:
        """Apply streamlining rules for existing clients."""
        # Documents that can be marked as waivable
        waivable_if_current = [
            "Personal Financial Statement",
            "Schedule of Real Estate Owned",
            "Articles of Organization",
            "Operating Agreement",
            "EIN Letter or W-9",
        ]
        
        for doc in checklist.required_documents:
            if doc.name in waivable_if_current:
                # Mark as potentially waivable (still needs validation)
                pass  # In real implementation, set flag for waiver eligibility
    
    def check_document_currency(
        self,
        document_name: str,
        document_date: datetime,
        reference_date: datetime = None
    ) -> Tuple[bool, Optional[str]]:
        """
        Check if a document is current.
        
        Args:
            document_name: Name of document
            document_date: Date of document
            reference_date: Date to check against (default: today)
            
        Returns:
            Tuple of (is_current, message)
        """
        if reference_date is None:
            reference_date = datetime.now()
        
        # Find currency requirement
        doc_key = document_name.lower().replace(" ", "_")
        max_age = self.CURRENCY_REQUIREMENTS.get(doc_key)
        
        if max_age is None:
            return (True, "No currency requirement found")
        
        age = (reference_date - document_date).days
        is_current = age <= max_age
        
        message = f"Document is {age} days old (max {max_age} allowed)"
        
        return (is_current, message)
```

---

## 13.9 Integration with INSPIRE Phase 5-6

Diligence checklist generation in INSPIRE Phase 5-6:

1. **Checklist Generation:** Upon entry to Phase 5-6, system generates complete diligence checklist based on loan parameters
2. **Document Classification:** System tags each document with category and currency requirement
3. **Existing Client Streamlining:** If existing client, system marks waivable documents and displays "waived - use on file"
4. **Tracking:** As documents are uploaded to data room, system updates checklist progress
5. **Expiration Monitoring:** System alerts if any document approaches expiration
6. **Closing Readiness:** System prevents Phase 6 closing approval until all required documents are current

---

## Open Questions

None at this time. All document requirements have been synthesized from investor guidelines (Eastview DSCR Guidelines v7.2, ArchWest RTL Guidelines, ArchWest DSCR Guidelines).

---

*End of Section 13*

